<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="../css/editor.css" rel="stylesheet" />
    <link rel="icon" href="/icons/shiori.ico" sizes="any" />
    <title>Shiori</title>
  </head>

  <body>
    <!-- Top toolbar -->
    <div class="toolbar">
      <div class="toolbar-left">
        <button class="pill" id="back-btn" type="button">‚Üê Back</button>
        <button
          class="pill icon"
          id="toc-btn"
          type="button"
          aria-label="Table of contents"
        >
          ‚ò∞
        </button>
        <div class="ch-wrap">
          <span class="ch-label">Ch.</span>
          <input
            id="chapter-input"
            type="number"
            min="1"
            step="1"
            placeholder="‚Äî"
            aria-label="Chapter number"
          />
        </div>
        <div class="page-title-wrap">
          <input
            id="page-title-input"
            type="text"
            placeholder="Page title (optional)"
            aria-label="Page title"
          />
        </div>
        <button
          class="pill dropdown"
          id="page-pill"
          type="button"
          aria-haspopup="true"
          aria-expanded="false"
        >
          Pg. 1
        </button>
      </div>

      <div class="toolbar-right">
        <div class="pill muted" id="save-status">Saved</div>
        <button class="pill" type="button" id="shortcuts-btn">
          ‚ú® Shortcuts
        </button>
        <button
          class="pill"
          type="button"
          id="dual-view-btn"
          aria-pressed="false"
        >
          ‚Üî Dual View
        </button>
        <button
          class="pill"
          type="button"
          id="view-menu-btn"
          aria-haspopup="true"
          aria-expanded="false"
        >
          üëÅ View
        </button>
        <button class="pill" type="button" id="detect-annotations-btn">
          üîç Detect
        </button>
        <button class="pill" type="button" id="new-page-btn">
          Ôºã New Page
        </button>
      </div>
    </div>

    <!-- Slide-out TOC (pages only for now) -->
    <aside class="toc" id="toc" aria-hidden="true">
      <div class="toc-header">
        <div class="toc-title">Contents</div>
        <button
          class="pill icon"
          id="toc-close"
          type="button"
          aria-label="Close contents"
        >
          ‚úï
        </button>
      </div>

      <div class="toc-search">
        <input
          id="toc-search"
          type="text"
          placeholder="Search pages‚Ä¶"
          aria-label="Search contents"
        />
      </div>

      <div class="toc-body" id="toc-body">
        <!-- JS will render pages here -->
      </div>
    </aside>
    <div class="toc-backdrop" id="toc-backdrop" aria-hidden="true"></div>

    <!-- Page dropdown -->
    <div class="popover" id="page-popover" aria-hidden="true">
      <div class="popover-title">Go to page</div>
      <div class="popover-list" id="page-list"></div>
    </div>

    <!-- Shortcuts popover -->
    <div class="popover" id="shortcuts-popover" aria-hidden="true">
      <div class="popover-title">Shortcuts ‚ú®</div>
      <div class="popover-list">
        <div class="shortcut-row"><kbd>‚åò 1</kbd><span>Narration</span></div>
        <div class="shortcut-row"><kbd>‚åò 2</kbd><span>Dialogue</span></div>
        <div class="shortcut-row"><kbd>‚åò 3</kbd><span>SFX</span></div>
        <div class="shortcut-row"><kbd>‚åò 4</kbd><span>Thought</span></div>
        <div class="shortcut-row"><kbd>Esc</kbd><span>Close</span></div>
        <div class="shortcut-hint">
          (Format the selected block(s) ‚Äî otherwise the block your cursor is in.)
        </div>
      </div>
    </div>

    <!-- View options -->
    <div class="popover view-popover" id="view-popover" aria-hidden="true">
      <div class="popover-title">View options</div>
      <label class="view-toggle">
        <div class="view-toggle__text">
          <span class="view-toggle__label">Annotations</span>
          <span class="view-toggle__hint">Show highlight colors and tooltips.</span>
        </div>
        <div class="view-switch">
          <input type="checkbox" id="toggle-annotations" checked />
          <span class="view-switch__slider" aria-hidden="true"></span>
        </div>
      </label>
      <label class="view-toggle">
        <div class="view-toggle__text">
          <span class="view-toggle__label">Furigana</span>
          <span class="view-toggle__hint">Display the pronunciation above Kanji.</span>
        </div>
        <div class="view-switch">
          <input type="checkbox" id="toggle-furigana" checked />
          <span class="view-switch__slider" aria-hidden="true"></span>
        </div>
      </label>
    </div>

    <!-- Page + Memo workspace -->
    <div class="workspace" id="workspace">
      <main class="page" id="page-layout">
        <div class="page-header">
          <div class="page-title" id="book-title">Untitled</div>
          <div class="page-meta" id="book-meta">‚Äî ¬∑ Pg. 1</div>
        </div>

        <div
          id="editor"
          class="editor"
          contenteditable="true"
          spellcheck="false"
          data-placeholder="Start writing‚Ä¶"
        ></div>
      </main>

      <aside class="memo-pane" id="memo-pane" aria-label="Brain dump memo">
        <div class="memo-pane__header">
          <div>
            <div class="memo-pane__title">Memo</div>
            <div class="memo-pane__subtitle">Jot quick thoughts or snippets</div>
          </div>
        </div>
        <div
          id="memo-editor"
          class="memo-editor"
          contenteditable="true"
          spellcheck="false"
          data-placeholder="Write anything‚Ä¶"
        ></div>
      </aside>
    </div>
    <!-- Toasts -->
    <div
      class="toast-host"
      id="toast-host"
      aria-live="polite"
      aria-atomic="true"
    ></div>

    <button class="annotate-btn" id="annotate-btn" type="button">Annotate</button>

    <aside class="annotation-panel" id="annotation-panel" aria-hidden="true">
      <div class="annotation-panel__header">
        <div>
          <div class="annotation-panel__title">Annotation</div>
          <div class="annotation-panel__subtitle">
            Highlight text in the script, then click Annotate.
          </div>
        </div>
        <button class="pill ghost" type="button" id="annotation-close-btn">‚úï</button>
      </div>

      <div class="annotation-panel__selection">
        <div class="annotation-label">Selected text</div>
        <div class="annotation-selected" id="annotation-selected-text">‚Äî</div>
      </div>

      <form class="annotation-form" id="annotation-form" autocomplete="off">
        <label class="annotation-field">
          <span class="annotation-label">Reading</span>
          <input type="text" id="annotation-reading" placeholder="e.g., „Åü„ÇÇ„Çì" />
        </label>

        <div class="annotation-field">
          <span class="annotation-label">Reading type</span>
          <div class="annotation-toggle">
            <label>
              <input type="radio" name="annotation-reading-type" value="kun" checked />
              <span>Kun</span>
            </label>
            <label>
              <input type="radio" name="annotation-reading-type" value="on" />
              <span>On</span>
            </label>
          </div>
        </div>

        <label class="annotation-field">
          <span class="annotation-label">Meaning</span>
          <textarea id="annotation-meaning" rows="2" placeholder="Translation or definition"></textarea>
        </label>

        <label class="annotation-field">
          <span class="annotation-label">Notes</span>
          <textarea id="annotation-notes" rows="3" placeholder="Grammar, source, mnemonics‚Ä¶"></textarea>
        </label>

        <div class="annotation-actions">
          <button class="pill ghost" type="button" id="annotation-cancel-btn">Cancel</button>
          <button class="pill primary" type="submit">Save annotation</button>
        </div>
      </form>

      <div class="annotation-list" id="annotation-list"></div>
    </aside>

    <!-- Confirm modal -->
    <div class="modal" id="confirm-modal" aria-hidden="true">
      <div class="modal__backdrop" data-close-confirm="true"></div>
      <div
        class="modal__panel"
        role="dialog"
        aria-modal="true"
        aria-labelledby="confirm-modal-title"
      >
        <div class="modal__header">
          <h3 class="modal__title" id="confirm-modal-title">Delete chapter?</h3>
          <button
            class="modal__close pill"
            type="button"
            aria-label="Close"
            data-close-confirm="true"
          >
            ‚úï
          </button>
        </div>
        <div class="modal__body" id="confirm-modal-text">
          This will remove every page inside that chapter.
        </div>
        <div class="modal__actions">
          <button class="pill ghost" type="button" data-close-confirm="true">
            Cancel
          </button>
          <button class="pill danger" type="button" id="confirm-modal-confirm">
            Delete
          </button>
        </div>
      </div>
    </div>

    <script src="../js/editor.js"></script>
  </body>
</html>
